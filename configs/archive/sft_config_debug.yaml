# ==============================================================================
# DEBUG/QUICK EXPERIMENT Configuration
# Fast training configuration for testing and development
# ==============================================================================

# ==============================================================================
# Model Configuration
# ==============================================================================
model:
  name: "Qwen2.5-Math-1.5B"
  path: "pretrained_models/Qwen2.5-Math-1.5B"
  trust_remote_code: true

# ==============================================================================
# LoRA Configuration (Smaller for faster training)
# ==============================================================================
lora:
  enabled: true
  r: 8  # Smaller rank for faster training
  alpha: 16
  dropout: 0.05
  target_modules:
    - "q_proj"
    - "v_proj"  # Fewer modules for speed
  bias: "none"
  task_type: "CAUSAL_LM"

# ==============================================================================
# Data Configuration
# ==============================================================================
data:
  train_files:
    - "data/cot_generated/cot_deepseek_reasoner_gsm8k_train_10_1120_1548/cot_data.json"  # Small dataset for quick test
  dataset_name: "gsm8k"
  max_seq_length: 1024  # Shorter for speed
  train_split_ratio: 0.8  # More aggressive split for small data
  num_workers: 2

# ==============================================================================
# Training Hyperparameters (Fast settings)
# ==============================================================================
training:
  output_dir: "results/sft_checkpoints"
  run_name: "debug_quick_test"
  
  per_device_train_batch_size: 4  # Larger batch for speed
  per_device_eval_batch_size: 4
  gradient_accumulation_steps: 2  # Less accumulation
  
  num_train_epochs: 1  # Just 1 epoch for testing
  max_steps: 50  # Stop after 50 steps
  
  learning_rate: 3.0e-4  # Slightly higher for faster convergence
  lr_scheduler_type: "constant"  # No warmup/decay for speed
  warmup_ratio: 0.0
  
  weight_decay: 0.0  # Disable for speed
  max_grad_norm: 1.0

# ==============================================================================
# Optimizer Configuration
# ==============================================================================
optimizer:
  type: "adamw_torch"
  adam_beta1: 0.9
  adam_beta2: 0.999
  adam_epsilon: 1.0e-8

# ==============================================================================
# Precision and Memory
# ==============================================================================
precision:
  fp16: false
  bf16: true
  fp16_full_eval: false
  bf16_full_eval: false

memory:
  gradient_checkpointing: false  # Disable for speed

# ==============================================================================
# Checkpoint and Logging
# ==============================================================================
checkpoint:
  save_strategy: "steps"
  save_steps: 25  # Save frequently for debugging
  save_total_limit: 2
  save_optimizer: false  # Don't save optimizer state for speed
  load_best_model_at_end: false
  metric_for_best_model: "eval_loss"
  greater_is_better: false

logging:
  logging_strategy: "steps"
  logging_steps: 5  # Log frequently
  logging_dir: "logs"
  report_to: ["tensorboard"]
  log_level: "info"
  log_on_each_node: true

# ==============================================================================
# Evaluation Configuration
# ==============================================================================
evaluation:
  evaluation_strategy: "steps"
  eval_steps: 25  # Eval frequently
  per_device_eval_batch_size: 4
  eval_accumulation_steps: null

# ==============================================================================
# Early Stopping (disabled for debug)
# ==============================================================================
early_stopping:
  enabled: false

# ==============================================================================
# DeepSpeed (disabled for debug)
# ==============================================================================
deepspeed:
  enabled: false

# ==============================================================================
# Miscellaneous
# ==============================================================================
misc:
  seed: 42
  data_seed: 42
  no_cuda: false
  dataloader_num_workers: 2
  dataloader_pin_memory: true
  remove_unused_columns: true
  label_smoothing_factor: 0.0
  group_by_length: false
  resume_from_checkpoint: null
  ignore_data_skip: false
  disable_tqdm: false
  push_to_hub: false


