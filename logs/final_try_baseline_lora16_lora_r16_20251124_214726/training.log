2025-11-24 21:47:26,928 - INFO - ================================================================================
2025-11-24 21:47:26,928 - INFO - Training Configuration
2025-11-24 21:47:26,928 - INFO - ================================================================================
2025-11-24 21:47:26,928 - INFO - Round Name: final_try_baseline_lora16
2025-11-24 21:47:26,928 - INFO - Mode: lora
2025-11-24 21:47:26,928 - INFO - Model: pretrained_models/Qwen2.5-Math-1.5B
2025-11-24 21:47:26,928 - INFO - Data: data/cot_generated/first_round_final_gsm8k_math/first_round_final_gsm8k_math.json
2025-11-24 21:47:26,928 - INFO - Output: checkpoints/final_try_baseline_lora16_lora_r16_20251124_214726
2025-11-24 21:47:26,928 - INFO - Logs: logs/final_try_baseline_lora16_lora_r16_20251124_214726
2025-11-24 21:47:26,928 - INFO - GPUs: 2
2025-11-24 21:47:26,928 - INFO - Epochs: 5
2025-11-24 21:47:26,928 - INFO - Batch size: 16
2025-11-24 21:47:26,928 - INFO - Gradient accumulation: 4
2025-11-24 21:47:26,928 - INFO - Max sequence length: 2048
2025-11-24 21:47:26,928 - INFO - Gradient checkpointing: False
2025-11-24 21:47:26,929 - INFO - Enable evaluation: True
2025-11-24 21:47:26,929 - INFO - Evaluation frequency: every 1 epoch(s)
2025-11-24 21:47:26,929 - INFO - LoRA rank: 16
2025-11-24 21:47:26,929 - INFO - ================================================================================
2025-11-24 21:47:26,929 - INFO - Loading data from: data/cot_generated/first_round_final_gsm8k_math/first_round_final_gsm8k_math.json
2025-11-24 21:47:27,687 - INFO - Filtered to 18946 correct samples
2025-11-24 21:47:27,687 - INFO - Total samples: 18946
2025-11-24 21:47:27,687 - INFO - Sample columns: ['index', 'question', 'ground_truth', 'predicted_answer', 'thinking_process', 'solution', 'raw_output', 'teacher_model', 'tokens_used', 'finish_reason', 'correct', 'status', '_validation', 'generation_round', 'dataset', 'attempt_count', 'attempts_history']
2025-11-24 21:47:27,687 - INFO - Sample question: Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How m...
2025-11-24 21:47:28,366 - INFO - Training dataset size: 18946
2025-11-24 21:47:28,392 - INFO - Loading model: pretrained_models/Qwen2.5-Math-1.5B
2025-11-24 21:47:29,966 - INFO - Model loaded on: cuda:0
2025-11-24 21:47:29,966 - INFO - Configuring LoRA with rank=16
2025-11-24 21:47:29,966 - INFO - Dataset size: 18946
2025-11-24 21:47:29,966 - INFO - Steps per epoch: 297
2025-11-24 21:47:29,966 - INFO - Save checkpoint every 297 steps (1 epochs)
2025-11-24 21:47:29,966 - INFO - 
Loading evaluation datasets...
2025-11-24 21:47:29,966 - INFO - Evaluation will run every 1 epoch(s)
2025-11-24 21:47:29,972 - INFO - Loaded 500 samples from gsm8k
2025-11-24 21:47:29,975 - INFO - Loaded 500 samples from math500
2025-11-24 21:47:29,975 - INFO - Loaded evaluation datasets: ['gsm8k', 'math500']
2025-11-24 21:47:29,975 - INFO - Training metrics will be saved to: logs/final_try_baseline_lora16_lora_r16_20251124_214726/training_metrics.csv
2025-11-24 21:48:16,706 - INFO - Starting training...
2025-11-24 22:13:27,021 - INFO - Epoch 1.0 completed at step 297
2025-11-24 22:13:27,021 - INFO - 
================================================================================
2025-11-24 22:13:27,021 - INFO - Running evaluation at epoch 1
2025-11-24 22:13:27,022 - INFO - ================================================================================
2025-11-24 22:13:27,022 - INFO - Evaluating on gsm8k...
2025-11-24 23:38:09,001 - INFO -   gsm8k accuracy: 0.6580
2025-11-24 23:38:09,002 - INFO - Evaluating on math500...
2025-11-25 01:21:25,349 - INFO -   math500 accuracy: 0.2960
2025-11-25 01:21:25,357 - INFO - Logged evaluation results to W&B
2025-11-25 01:21:25,357 - INFO - ================================================================================

