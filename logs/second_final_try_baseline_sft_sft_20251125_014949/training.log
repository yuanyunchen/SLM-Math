2025-11-25 01:49:49,899 - INFO - ================================================================================
2025-11-25 01:49:49,899 - INFO - Training Configuration
2025-11-25 01:49:49,900 - INFO - ================================================================================
2025-11-25 01:49:49,900 - INFO - Round Name: second_final_try_baseline_sft
2025-11-25 01:49:49,900 - INFO - Mode: sft
2025-11-25 01:49:49,900 - INFO - Model: pretrained_models/Qwen2.5-Math-1.5B
2025-11-25 01:49:49,900 - INFO - Data: data/cot_generated/first_round_final_gsm8k_math/first_round_final_gsm8k_math.json
2025-11-25 01:49:49,900 - INFO - Output: checkpoints/second_final_try_baseline_sft_sft_20251125_014949
2025-11-25 01:49:49,900 - INFO - Logs: logs/second_final_try_baseline_sft_sft_20251125_014949
2025-11-25 01:49:49,900 - INFO - GPUs: 1
2025-11-25 01:49:49,900 - INFO - Epochs: 6
2025-11-25 01:49:49,900 - INFO - Batch size: 16
2025-11-25 01:49:49,900 - INFO - Gradient accumulation: 4
2025-11-25 01:49:49,900 - INFO - Max sequence length: 2048
2025-11-25 01:49:49,900 - INFO - Gradient checkpointing: False
2025-11-25 01:49:49,900 - INFO - Enable evaluation: True
2025-11-25 01:49:49,900 - INFO - Evaluation frequency: every 1 epoch(s)
2025-11-25 01:49:49,900 - INFO - ================================================================================
2025-11-25 01:49:49,900 - INFO - Loading data from: data/cot_generated/first_round_final_gsm8k_math/first_round_final_gsm8k_math.json
2025-11-25 01:49:50,651 - INFO - Filtered to 18946 correct samples
2025-11-25 01:49:50,651 - INFO - Total samples: 18946
2025-11-25 01:49:50,651 - INFO - Sample columns: ['index', 'question', 'ground_truth', 'predicted_answer', 'thinking_process', 'solution', 'raw_output', 'teacher_model', 'tokens_used', 'finish_reason', 'correct', 'status', '_validation', 'generation_round', 'dataset', 'attempt_count', 'attempts_history']
2025-11-25 01:49:50,651 - INFO - Sample question: Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How m...
2025-11-25 01:49:51,308 - INFO - Training dataset size: 18946
2025-11-25 01:49:51,334 - INFO - Loading model: pretrained_models/Qwen2.5-Math-1.5B
2025-11-25 01:49:52,803 - INFO - Model loaded on: cuda:0
2025-11-25 01:49:52,803 - INFO - Dataset size: 18946
2025-11-25 01:49:52,803 - INFO - Steps per epoch: 297
2025-11-25 01:49:52,803 - INFO - Save checkpoint every 594 steps (2 epochs)
2025-11-25 01:49:52,803 - INFO - 
Loading evaluation datasets...
2025-11-25 01:49:52,803 - INFO - Evaluation will run every 1 epoch(s)
2025-11-25 01:49:52,810 - INFO - Loaded 200 samples from gsm8k
2025-11-25 01:49:52,813 - INFO - Loaded 200 samples from math500
2025-11-25 01:49:52,813 - INFO - Loaded evaluation datasets: ['gsm8k', 'math500']
2025-11-25 01:49:52,813 - INFO - Training metrics will be saved to: logs/second_final_try_baseline_sft_sft_20251125_014949/training_metrics.csv
2025-11-25 01:50:38,359 - INFO - Starting training...
2025-11-25 02:22:43,188 - INFO - Epoch 1.0 completed at step 297
2025-11-25 02:22:43,188 - INFO - 
================================================================================
2025-11-25 02:22:43,188 - INFO - Running evaluation at epoch 1
2025-11-25 02:22:43,189 - INFO - ================================================================================
2025-11-25 02:22:43,189 - INFO - Evaluating on gsm8k...
2025-11-25 02:49:04,175 - INFO - Saved 10 sample logs to logs/second_final_try_baseline_sft_sft_20251125_014949/eval_samples_gsm8k_20251125_024904.txt
2025-11-25 02:49:04,176 - INFO -   gsm8k accuracy: 0.6150
2025-11-25 02:49:04,176 - INFO - Evaluating on math500...
2025-11-25 03:32:51,294 - INFO - Saved 10 sample logs to logs/second_final_try_baseline_sft_sft_20251125_014949/eval_samples_math500_20251125_033251.txt
2025-11-25 03:32:51,294 - INFO -   math500 accuracy: 0.5500
2025-11-25 03:32:51,297 - INFO - Logged evaluation results to W&B
2025-11-25 03:32:51,297 - INFO - ================================================================================

2025-11-25 04:05:01,511 - INFO - Epoch 2.0 completed at step 594
2025-11-25 04:05:01,512 - INFO - 
================================================================================
2025-11-25 04:05:01,512 - INFO - Running evaluation at epoch 2
2025-11-25 04:05:01,512 - INFO - ================================================================================
2025-11-25 04:05:01,512 - INFO - Evaluating on gsm8k...
2025-11-25 04:29:47,410 - INFO - Saved 10 sample logs to logs/second_final_try_baseline_sft_sft_20251125_014949/eval_samples_gsm8k_20251125_042947.txt
2025-11-25 04:29:47,410 - INFO -   gsm8k accuracy: 0.6200
2025-11-25 04:29:47,410 - INFO - Evaluating on math500...
2025-11-25 05:14:44,506 - INFO - Saved 10 sample logs to logs/second_final_try_baseline_sft_sft_20251125_014949/eval_samples_math500_20251125_051444.txt
2025-11-25 05:14:44,507 - INFO -   math500 accuracy: 0.5600
2025-11-25 05:14:44,510 - INFO - Logged evaluation results to W&B
2025-11-25 05:14:44,510 - INFO - ================================================================================

2025-11-25 05:46:46,189 - INFO - Epoch 3.0 completed at step 891
2025-11-25 05:46:46,189 - INFO - 
================================================================================
2025-11-25 05:46:46,190 - INFO - Running evaluation at epoch 3
2025-11-25 05:46:46,190 - INFO - ================================================================================
2025-11-25 05:46:46,190 - INFO - Evaluating on gsm8k...
2025-11-25 06:12:27,716 - INFO - Saved 10 sample logs to logs/second_final_try_baseline_sft_sft_20251125_014949/eval_samples_gsm8k_20251125_061227.txt
2025-11-25 06:12:27,717 - INFO -   gsm8k accuracy: 0.5850
2025-11-25 06:12:27,717 - INFO - Evaluating on math500...
2025-11-25 06:57:17,290 - INFO - Saved 10 sample logs to logs/second_final_try_baseline_sft_sft_20251125_014949/eval_samples_math500_20251125_065717.txt
2025-11-25 06:57:17,291 - INFO -   math500 accuracy: 0.6000
2025-11-25 06:57:17,294 - INFO - Logged evaluation results to W&B
2025-11-25 06:57:17,294 - INFO - ================================================================================

2025-11-25 07:29:27,875 - INFO - Epoch 4.0 completed at step 1188
2025-11-25 07:29:27,875 - INFO - 
================================================================================
2025-11-25 07:29:27,875 - INFO - Running evaluation at epoch 4
2025-11-25 07:29:27,875 - INFO - ================================================================================
2025-11-25 07:29:27,876 - INFO - Evaluating on gsm8k...
2025-11-25 07:55:09,205 - INFO - Saved 10 sample logs to logs/second_final_try_baseline_sft_sft_20251125_014949/eval_samples_gsm8k_20251125_075509.txt
2025-11-25 07:55:09,205 - INFO -   gsm8k accuracy: 0.6350
2025-11-25 07:55:09,206 - INFO - Evaluating on math500...
2025-11-25 08:38:26,419 - INFO - Saved 10 sample logs to logs/second_final_try_baseline_sft_sft_20251125_014949/eval_samples_math500_20251125_083826.txt
2025-11-25 08:38:26,419 - INFO -   math500 accuracy: 0.5650
2025-11-25 08:38:26,422 - INFO - Logged evaluation results to W&B
2025-11-25 08:38:26,422 - INFO - ================================================================================

2025-11-25 09:10:25,690 - INFO - Epoch 5.0 completed at step 1485
2025-11-25 09:10:25,691 - INFO - 
================================================================================
2025-11-25 09:10:25,691 - INFO - Running evaluation at epoch 5
2025-11-25 09:10:25,691 - INFO - ================================================================================
2025-11-25 09:10:25,691 - INFO - Evaluating on gsm8k...
2025-11-25 09:36:48,848 - INFO - Saved 10 sample logs to logs/second_final_try_baseline_sft_sft_20251125_014949/eval_samples_gsm8k_20251125_093648.txt
2025-11-25 09:36:48,849 - INFO -   gsm8k accuracy: 0.6250
2025-11-25 09:36:48,849 - INFO - Evaluating on math500...
